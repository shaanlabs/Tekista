{% extends 'layouts/app.html' %}

{% block title %}{{ project.title }} - Tekista{% endblock %}

{% block content %}
<div class="max-w-5xl">
  <div class="flex items-start justify-between mb-6">
    <div>
      <h1 class="text-xl font-semibold text-white">{{ project.title }}</h1>
      {% if project.description %}
        <p class="mt-1 text-sm text-gray-400">{{ project.description }}</p>
      {% endif %}
      <div class="mt-2 text-sm text-gray-400">Deadline: {{ project.deadline or '—' }}</div>
      <div class="mt-3">
        <div class="w-64 h-2 rounded bg-white/10 overflow-hidden">
          <div class="h-2 bg-accent" style="width: {{ project.progress() }}%"></div>
        </div>
        <div class="text-xs text-gray-400 mt-1">Progress: {{ project.progress() }}%</div>
      </div>
    </div>
    <div class="shrink-0">
      <a href="{{ url_for('projects.edit_project', project_id=project.id) }}" class="px-3 py-1.5 mr-2 rounded border border-white/10 bg-white/5 text-sm text-white hover:bg-white/10">Edit</a>
      <a href="{{ url_for('tasks.create_task', project_id=project.id) }}" class="px-3 py-1.5 rounded border border-white/10 bg-accent/20 text-sm text-white hover:bg-accent/30">Add Task</a>
    </div>
  </div>

  <div class="rounded border border-white/10 bg-white/5">
    <div class="px-4 py-2 text-xs uppercase text-gray-400 border-b border-white/10">Tasks</div>
    {% if tasks %}
      {% for t in tasks %}
      <div class="px-4 py-3 border-b border-white/5 hover:bg-white/10">
        <div class="flex items-center justify-between gap-4">
          <div class="min-w-0">
            <a href="{{ url_for('tasks.task_detail', task_id=t.id) }}" class="text-sm text-white hover:underline">{{ t.title }}</a>
            {% if t.description %}
              <div class="text-xs text-gray-400 truncate">{{ t.description }}</div>
            {% endif %}
            <div class="text-xs text-gray-500 mt-1">Assignees: {% for u in t.assignees %}{{ u.username }}{% if not loop.last %}, {% endif %}{% endfor %}</div>
          </div>
          <div class="text-right shrink-0">
            <div><span class="text-xs px-2 py-1 rounded border border-white/10 text-gray-300">{{ t.status }}</span></div>
            <div class="text-xs text-gray-400 mt-1">Due: {{ t.due_date or '—' }}</div>
          </div>
        </div>
      </div>
      {% endfor %}
    {% else %}
      <div class="px-4 py-6 text-sm text-gray-400">No tasks yet.</div>
    {% endif %}
  </div>
</div>
{% endblock %}
