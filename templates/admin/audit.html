{% extends 'layouts/app.html' %}
{% block title %}Admin · Audit - Tekista{% endblock %}
{% block content %}
<div class="max-w-6xl">
  <h1 class="text-xl font-semibold text-white mb-4">Admin · Audit</h1>

  <form method="get" class="mb-4 grid grid-cols-1 sm:grid-cols-4 gap-2 items-end">
    <div>
      <label class="block text-xs text-gray-400 mb-1">Action</label>
      <select name="action" class="w-full px-3 py-2 rounded bg-white/5 border border-white/10 text-gray-200">
        <option value="">All</option>
        {% for a in actions %}
        <option value="{{ a }}" {% if request.args.get('action') == a %}selected{% endif %}>{{ a }}</option>
        {% endfor %}
      </select>
    </div>
    <div>
      <label class="block text-xs text-gray-400 mb-1">Actor</label>
      <input type="text" name="actor" value="{{ request.args.get('actor','') }}" placeholder="username contains" class="w-full px-3 py-2 rounded bg-white/5 border border-white/10 text-gray-200 placeholder-gray-500" />
    </div>
    <div>
      <label class="block text-xs text-gray-400 mb-1">Days</label>
      <input type="number" min="1" name="days" value="{{ request.args.get('days') or 30 }}" class="w-full px-3 py-2 rounded bg-white/5 border border-white/10 text-gray-200" />
    </div>
    <div>
      <button class="w-full px-3 py-2 rounded border border-white/10 bg-white/5 text-white text-sm hover:bg-white/10">Apply</button>
    </div>
  </form>

  <div class="rounded border border-white/10 bg-white/5">
    <div class="px-4 py-2 text-xs uppercase text-gray-400 border-b border-white/10">Recent Activity</div>
    {% if logs %}
    <div class="divide-y divide-white/5">
      {% for l in logs %}
      <div class="px-4 py-3 flex items-center justify-between gap-4">
        <div class="min-w-0">
          <div class="text-sm text-white truncate">{{ l.action }} · {{ l.target_type }}:{{ l.target_id }}</div>
          <div class="text-xs text-gray-400 truncate">{{ l.meta }}</div>
        </div>
        <div class="shrink-0 text-xs text-gray-400">{{ l.created_at }}</div>
      </div>
      {% endfor %}
    </div>
    {% else %}
    <div class="px-4 py-6 text-sm text-gray-400">No audit entries in this period.</div>
    {% endif %}
  </div>
</div>
{% endblock %}
